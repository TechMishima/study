# ToDo
データベースの動画学習<br>
暗記する範囲と頭を使う範囲がある。集中できる環境があると良い<br>
https://www.youtube.com/@kihonzyouhou/playlists

# TIL データベース

## 1.データベースの基本

### データベースとDBMS

- データベース
  - 決まった形で整理されたデータの集まりのこと
- データベース管理システム(DBMS)
  - データベースの操作や制御機能を持つソフトウェア

### 関係型データベース

データベースはデータの保持形式によっていくつかの種類がある。<br>
表形式で整理されたデータベースの事を、「リレーショナルデータベース」もしくは「RDB/関係型データベース」と呼ばれる。

<b>RDBの各要素の呼び方</b>
- 表、テーブル
- 行、レコード、組、タプル
- 列、フィールド、属性

### スキーマ

データベースを設計する際は、データの独立性を高めるため、「3層スキーマ構造」を取っている。

- 外部スキーマ(見た目)
  - 「利用者」やアプリケーションから見たデータベースの見た目
- 概念スキーマ(データの構造)
  - 「開発者」かた見たデータベースの論理的構造
- 内部スキーマ(ハードウェアとの関係)
  - データベースを記憶媒体に「物理的に記録する際の構造」

<font color="yellow">
「見た目・データ構造・物理的構造」に分けてデータベースを設計し<br>
「独立性」を向上させている！！
</font>

### 過去問演習

<font color="yellow">
属性はカラムと一緒
</font>

## 2.データベースの正規化1

### 主キーと複合キー

- 「主キー」 : 表中の行を1つに特定するための列<br>
下記の2つを兼ね備えている
  - 「一意制約」 : キーの値が重複しない
  - 「非NULL制約」 : キーの値が空でない

- 「複合キー」 : 複数の列を組み合わせて主キーの役割とする

### 外部キー

- 「外部キー」 : 表と表をくっつけるため、他の表の主キーを参照する列のこと

### 正規化

「正規化」 : データを整理・削除し、矛盾や重複の無い優れたデータベースを作成すること

- 第1正規化(1つのセルには1つの値！)
  - 列方向のデータ重複を行方向に「移動」
  - 不要な列を「削除」する
- 第2正規化(依存する項目の分離)
  - 主キーや複合キーを基に「表を分割する」
- 第3正規化(非キー同士の分割)
  - 第2正規化で分割できなかった部分を「さらに分割する」

## 3.データベースの正規化2

### 関数従属性

- 「部分関数従属性」 : 複合キーの一部の項目だけで列の値が一意に決まる関係
- 「関数従属性」 : 主キーの項目だけで列の値が一意に決まる関係

## 4.トランザクション処理

- トランザクション : データベース操作に関する一連の処理

### ACID(アコイド)特性

ACID特性 : トランザクション処理を実施する際に要求される特性

- Atomicity(原子性)
  - トランザクションは｛すべて実行完了｝｛全く処理されていない｝のいずれかであること「中途半端に一部分だけ処理を実施しない」
- Consistency(一貫性)
  - データベースの内容に「矛盾が無い」こと
- Isolation(隔離性)
  - 複数のトランザクションを同時に実行しても順番に実行しても結果が等しくなること（トランザクションが「相互に影響を及ぼさない」）
- Durability(耐久性)
  - 障害が発生してもデータベースから「データが消失しない」こと

### 排他的制御

ACID特性を担保するための1つの手段として「排他制御」を実施

- 「共有ロック」
  - ほかのユーザーはデータを「見ることは出来るが、更新は出来ない」<br>
  （データの共有は可能なので共有ロック）
- 「専有ロック」
  - 他のユーザーはデータを「見ることも更新することも出来ない」<br>
  （データを占有するので専有ロック）

「デッドロック」 : 2つのトランザクション互いにロックし、待ち続けてしまうことをデッドロックと呼ぶ。

### ロックの粒度

ロックをかける際の粒度（ロックをかける範囲の大き）によって特徴が異なる

- 粒度が大きい
  - 〇 : ロックの管理が簡単
  - × : ロックの競合により待ち時間が増え、処理効率低下
- 粒度が小さい
 - 〇 : ロックの競合が少なくなり、処理効率向上
 - × : ロックの管理が困難

### ストアドプロシージャ

「ストアドプロシージャ」 : 利用頻度の高いSQL命令群を予めDBMS上に用意しておき、ネットワークの負荷の低減や処理速度向上を実現すること。

よく使うSQLの命令群を「プロシージャ」と呼ぶ。

## 5.データの復元方法

データベースにはアプリケーション等で必要な大切なデータが保管されている<br>
データベースは「バックアップファイル」と「ジャーナルファイル」(=ログファイル)でデータを保護する

- バックアップファイル
  - 定期的にデータベースの内容をコピーして別ファイルに保管
- ジャーナルファイル
  - 更新履歴を記録したファイル

### ジャーナルファイルの種類

- 「更新前ジャーナル」
  - 処理を更新する前の状態を記録する
- 「更新後ジャーナル」
  - 処理を更新した後の状態を記録する

### コミットとロールバック

「コミット」 : トランザクション内の一連の処理が全て更新できたことを確認して初めてデータベースに更新内容を反映(処理が全て反映される)

「ロールバック」 : 処理の途中で障害が発生した場合は更新前ジャーナルを使用して、トランザクション処理開始直前の状態に戻す(処理が一切反映されない)

### ロールフォワード

「ロールフォワード」 : システム障害発生時等によりデータが破損した際は、バックアップファイルと更新後ジャーナルを使用してデータベースを復元する

### ロールバックとロールフォワードの違い

- ロールバック
  - トランザクション処理中にエラーが発生した際
- ロールフォワード
  - システム障害等でデータが破損した際

### 分散データベースと2相コミット

「分散データベース」 : 複数のデータベースを見かけ上1つのデータベースとして扱うこと

「2相コミット」 : 分散データベースの際、全データベースにコミット可能か確認して、コミットもしくはロールバックを実施すること

## 6.関係演算とSQL

### 関係演算

関係演算とは関係データベース操作の事。

- 「選択」
  - 特定の行を取り出す
- 「射影」
  - 特定の列を取り出す
- 「結合」
  - 表を結合する

「ビュー表」 : 関係演算を用いて好きな列や行で仮想的に一時的なテーブルを作成する

### SQLの概要

「SQL」 : データベースを操作する命令

- SQL
  - DDL(Data Definition Language)<br>データを定義する言語
    - CREATE : テーブルの作成
  - DML(Data Manipulation Language)<br>データを操作する言語
    - SELECT : レコードの抽出
    - UPDATE : レコードを更新する
    - DELETE : レコードを削除する
    - INSERT : レコードを挿入する

### CREATE文

テーブルを作成するコード
```
CREATE TABLE テーブル名(
  列名1 列名1の型 列名1の制約,
  列名2 列名2の型 列名2の制約,
)
```

制約
| 構文 | 制約名 | 意味 |
| :-- | :-: | --: |
| PRIMARY KEY | 主キー制約 | 値が重複せず、かつ空値を禁止する |
| FOREIGN KEY | 外部キー制約 | 外部キー制約 |
| REFERENCES | 外部キー制約 | 参照先の列にある項目と整合性をとる |
| UNIQUE | 一意制約 | 値の重複を禁止する |
| CHECK | 検査制約 | 値に条件を付ける |
| NOT NULL | NOT NULL制約 | 空値を禁止する |

ビューを作成するコード
```
CREATE VIEW ビュー名 AS SELECT文
```

### SELECT文

レコードやカラムを選択するコード

```
SELECT 販売日, 商品名
FROM 販売データ
WHERE 販売日="2022/04/21"
```

### UPDATE文

レコードを更新するコード

```
UPDATE 販売データ
SET 単価=150
WHERE 商品名="ボールペン"
```

### DELETE文

レコードを削除するコード

```
DELETE
FROM 販売データ
WHERE 商品名="ボールペン"
```

### INSERT文

レコードを挿入するコード

```
INSERT INTO 販売データ
  (販売ID, 商品名, 単価)
VALUE ("PO0007", "ノート", "200")
```

## 7.SQL文法(SELECT文)

### 条件の指定

```
SELECT *
FROM 販売データ
WHERE 数量>8 OR 数量<2
```
- = < > ※<>（等しくない）
- AND OR NOT

### 表の結合

```
SELECT *
FROM 販売データ,商品データ
  WHERE 販売データ.商品名=商品データ.商品名
```

### 並び替え

```
SELECT *
FROM 販売データ
ORDER BY 販売日, 数量 DESC
```

- ASC : 昇順
- DESC : 降順

### グループ化

```
SELECT 販売日, SUM(売上)
FROM 販売データ
GROUP BY 販売日
```

- MAX, MIN, AVG, SUM, COUNT

### グループ化された行を選択

```
SELECT 販売日, SUM(売上)
FROM 販売データ
GROUP BY 販売日
HAVING SUM(売上) > 1000
```

### 参考 SQLの実行順序

- FROM
- WHERE
- GROUP BY
- HAVING
- SELECT
- ORDER BY

## 8.機械学習とディープラーニング

### ビッグデータ

「ビッグデータ」 : 大量・多様・高頻度のデータ

### AI

「AI」 : 人間の知能を機械で表現しようとした技術

### 機械学習とディープラーニングの違い

「機械学習」とはAIを実現するための仕組み

「ディープラーニング」は数ある機械学習の手法の中の1つ

### 機械学習

「機械学習」 : 大量データからコンピューターが学習を行って、データに潜むパターンを見つけ出すこと

- 「教師あり学習」
  - コンピューターに「問題と正解をセット」で提示して、コンピューターがそれぞれの特徴を学習する
- 「教師なし学習」
  - コンピューターに正解は提示せずに、与えられたデータの中から統計的な性質などに基づいて「データのグルーピングや集約」を実施する
- 「強化学習」
  - 個々の行動に対して得点が与えられ、その「得点を最大化する」ように試行錯誤して、最大得点を取得できる行動を学習する

### 補足

教師あり学習の学習データの事を「特徴量」と呼ぶ。

### ディープラーニング

ディープラーニング : ニューラルネットワークを用いて人間と同じような認識を実現する技術

ニューラルネットワーク : 人間の脳構造を模倣したアルゴリズム

## 9.テスト頻出のデータベース分野復習

https://www.youtube.com/watch?v=EXnq-eFGofE