# ToDo
データベースの動画学習<br>
暗記する範囲と頭を使う範囲がある。集中できる環境があると良い<br>
https://www.youtube.com/@kihonzyouhou/playlists

# TIL データベース

## 1.データベースの基本

### データベースとDBMS

- データベース
  - 決まった形で整理されたデータの集まりのこと
- データベース管理システム(DBMS)
  - データベースの操作や制御機能を持つソフトウェア

### 関係型データベース

データベースはデータの保持形式によっていくつかの種類がある。<br>
表形式で整理されたデータベースの事を、「リレーショナルデータベース」もしくは「RDB/関係型データベース」と呼ばれる。

<b>RDBの各要素の呼び方</b>
- 表、テーブル
- 行、レコード、組、タプル
- 列、フィールド、属性

### スキーマ

データベースを設計する際は、データの独立性を高めるため、「3層スキーマ構造」を取っている。

- 外部スキーマ(見た目)
  - 「利用者」やアプリケーションから見たデータベースの見た目
- 概念スキーマ(データの構造)
  - 「開発者」かた見たデータベースの論理的構造
- 内部スキーマ(ハードウェアとの関係)
  - データベースを記憶媒体に「物理的に記録する際の構造」

<font color="yellow">
「見た目・データ構造・物理的構造」に分けてデータベースを設計し<br>
「独立性」を向上させている！！
</font>

### 過去問演習

<font color="yellow">
属性はカラムと一緒
</font>

## 2.データベースの正規化1

### 主キーと複合キー

- 「主キー」 : 表中の行を1つに特定するための列<br>
下記の2つを兼ね備えている
  - 「一意制約」 : キーの値が重複しない
  - 「非NULL制約」 : キーの値が空でない

- 「複合キー」 : 複数の列を組み合わせて主キーの役割とする

### 外部キー

- 「外部キー」 : 表と表をくっつけるため、他の表の主キーを参照する列のこと

### 正規化

「正規化」 : データを整理・削除し、矛盾や重複の無い優れたデータベースを作成すること

- 第1正規化(1つのセルには1つの値！)
  - 列方向のデータ重複を行方向に「移動」
  - 不要な列を「削除」する
- 第2正規化(依存する項目の分離)
  - 主キーや複合キーを基に「表を分割する」
- 第3正規化(非キー同士の分割)
  - 第2正規化で分割できなかった部分を「さらに分割する」

## 3.データベースの正規化2

### 関数従属性

- 「部分関数従属性」 : 複合キーの一部の項目だけで列の値が一意に決まる関係
- 「関数従属性」 : 主キーの項目だけで列の値が一意に決まる関係

## 4.トランザクション処理

- トランザクション : データベース操作に関する一連の処理

### ACID(アコイド)特性

ACID特性 : トランザクション処理を実施する際に要求される特性

- Atomicity(原子性)
  - トランザクションは｛すべて実行完了｝｛全く処理されていない｝のいずれかであること「中途半端に一部分だけ処理を実施しない」
- Consistency(一貫性)
  - データベースの内容に「矛盾が無い」こと
- Isolation(隔離性)
  - 複数のトランザクションを同時に実行しても順番に実行しても結果が等しくなること（トランザクションが「相互に影響を及ぼさない」）
- Durability(耐久性)
  - 障害が発生してもデータベースから「データが消失しない」こと

### 排他的制御

ACID特性を担保するための1つの手段として「排他制御」を実施

- 「共有ロック」
  - ほかのユーザーはデータを「見ることは出来るが、更新は出来ない」<br>
  （データの共有は可能なので共有ロック）
- 「専有ロック」
  - 他のユーザーはデータを「見ることも更新することも出来ない」<br>
  （データを占有するので専有ロック）

「デッドロック」 : 2つのトランザクション互いにロックし、待ち続けてしまうことをデッドロックと呼ぶ。

### ロックの粒度

ロックをかける際の粒度（ロックをかける範囲の大き）によって特徴が異なる

- 粒度が大きい
  - 〇 : ロックの管理が簡単
  - × : ロックの競合により待ち時間が増え、処理効率低下
- 粒度が小さい
 - 〇 : ロックの競合が少なくなり、処理効率向上
 - × : ロックの管理が困難

### ストアドプロシージャ

「ストアドプロシージャ」 : 利用頻度の高いSQL命令群を予めDBMS上に用意しておき、ネットワークの負荷の低減や処理速度向上を実現すること。

よく使うSQLの命令群を「プロシージャ」と呼ぶ。

## 5.データの復元方法

データベースにはアプリケーション等で必要な大切なデータが保管されている<br>
データベースは「バックアップファイル」と「ジャーナルファイル」(=ログファイル)でデータを保護する

- バックアップファイル
  - 定期的にデータベースの内容をコピーして別ファイルに保管
- ジャーナルファイル
  - 更新履歴を記録したファイル